---
import { getCollection } from "astro:content";
import PageLayout from "@/layouts/Base";
import SocialList from "@/components/SocialList";
import MeImage from "../assets/image.webp";
import { sortMDByDate, getTagSlug, formatTagForDisplay } from "@/utils";
import { Image } from "astro:assets";

const MAX_POSTS = 10;
const allPosts = await getCollection("post");
const allPostsByDate = sortMDByDate(allPosts).slice(0, MAX_POSTS);
export const prerender = true;
---

<PageLayout meta={{ title: "Home" }}>
	<div class="home-page">
		<header class="home-hero">
			<div class="hero-content">
				<div class="hero-image">
					<Image
						src={MeImage}
						height={MeImage.height}
						width={MeImage.width}
						alt="Matthew Peck-Deloughry"
						class="profile-photo"
						transition:name={"profile-image"}
					/>
				</div>
				<div class="hero-text">
					<a class="u-url hidden" rel="me" href="https://deloughry.co.uk/">Matthew Peck-Deloughry</a>
					<a class="u-url hidden" href="acct:matt@deloughry.co.uk"></a>
					<h1 class="hero-title">
						<span class="text-link">Developer.</span><br />
						<span class="text-twitch">Streamer.</span><br />
						<span class="text-twitter line-through">Tweeter.</span><span class="text-mastodon">Tooter.</span><br />
						&amp; a little bit of everything <span class="text-accent dark:text-accent">Nerdy!</span><span class="font-bold">_</span>
					</h1>
				</div>
			</div>
		</header>

		<section class="about-section">
			<div class="about-card">
				<h2 class="section-title">
					Av' fun developing, Av' fun learning, then Av'a crack at engineering it!
				</h2>
				<div class="about-content">
					<p class="p-note">
						Aye up, I'm Matt (aka Dr_DinoMight ðŸ¦–ðŸ§¨), a developer of something around 15 years (I think!?
						They all blend into one and other now ðŸ˜–).<br /><br />
						I'm a developer for the brilliant HMA Digital here in South Yorkshire, UK.<br /><br />
						ðŸ’¬ I'm a Full Stack Developer who loves to tinker with anything and everything, I love to build,
						be it personal 1 person projects or large scale community projects, as long as it's code it floats
						my boat!<br /><br />
					</p>
					<SocialList />
				</div>
			</div>
		</section>

		<section class="recent-posts">
			<h2 class="section-title">Recent Posts</h2>
			<div class="posts-grid">
				{allPostsByDate.map((p) => (
					<article class="post-card">
						{p.data.ogImage && (
							<div class="post-card-image">
								<img src={p.data.ogImage} alt={p.data.title} />
							</div>
						)}
						<div class="post-card-content">
							<time datetime={p.data.publishDate.toISOString()} class="post-card-date">
								{new Date(p.data.publishDate).toLocaleDateString('en-GB', {
									year: 'numeric',
									month: 'short',
									day: 'numeric'
								})}
							</time>
							<h3 class="post-card-title">
								<a href={`/posts/${p.slug}/`}>{p.data.title}</a>
							</h3>
							{p.data.description && <p class="post-card-description">{p.data.description}</p>}
							{p.data.tags && p.data.tags.length > 0 && (
								<div class="post-card-tags">
									{p.data.tags.map((tag) => (
										<a href={`/tags/${getTagSlug(tag)}`} class="tag" title={`View posts with tag: ${formatTagForDisplay(tag)}`}>
											{formatTagForDisplay(tag)}
										</a>
									))}
								</div>
							)}
						</div>
					</article>
				))}
			</div>
		</section>
	</div>

	<style>
		.home-page {
			max-width: 1200px;
			margin: 0 auto;
			padding: 2rem;
		}

		.home-hero {
			margin-bottom: 4rem;
		}

		.hero-content {
			display: flex;
			align-items: center;
			gap: 3rem;
			background: var(--theme-bg);
			padding: 3rem;
			border-radius: 12px;
		}

		.hero-image {
			flex-shrink: 0;
		}

		.profile-photo {
			width: 200px;
			height: 200px;
			border-radius: 12px;
			box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
			transition: transform 0.3s ease;
		}

		.profile-photo:hover {
			transform: scale(1.05);
		}

		.hero-text {
			flex: 1;
		}

		.hero-title {
			font-size: 2.5rem;
			font-weight: 700;
			line-height: 1.2;
			margin: 0;
			font-family: 'Oswald', sans-serif;
			text-transform: uppercase;
			letter-spacing: 1px;
		}

		.about-section {
			margin-bottom: 4rem;
		}

		.about-card {
			background: var(--theme-bg);
			padding: 3rem;
			border-radius: 12px;
		}

		.section-title {
			font-size: 2rem;
			font-weight: 600;
			margin-bottom: 2rem;
			color: var(--theme-accent);
			font-family: 'Oswald', sans-serif;
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.about-content {
			display: grid;
			grid-template-columns: 1fr auto;
			gap: 2rem;
			align-items: start;
		}

		.p-note {
			font-size: 1.1rem;
			line-height: 1.7;
			color: var(--theme-text);
			margin: 0;
		}

		.recent-posts {
			margin-bottom: 2rem;
		}

		.posts-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
			gap: 2rem;
		}

		.post-card {
			background: var(--theme-bg);
			border-radius: 12px;
			overflow: hidden;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			transition: transform 0.3s ease, box-shadow 0.3s ease;
		}

		.post-card:hover {
			transform: translateY(-4px);
			box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
		}

		.post-card-image {
			position: relative;
			overflow: hidden;
			height: 200px;
		}

		.post-card-image img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			filter: grayscale(100%);
			transition: filter 0.3s ease;
		}

		.post-card:hover .post-card-image img {
			filter: grayscale(0%);
		}

		.post-card-content {
			padding: 1.5rem;
		}

		.post-card-date {
			display: block;
			font-size: 0.9rem;
			color: var(--theme-accent);
			font-weight: 600;
			margin-bottom: 0.5rem;
			font-family: 'Oswald', sans-serif;
			text-transform: uppercase;
			letter-spacing: 1px;
		}

		.post-card-title {
			margin: 0 0 0.75rem 0;
			font-size: 1.5rem;
			font-weight: 600;
			font-family: 'Oswald', sans-serif;
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.post-card-title a {
			color: var(--theme-text);
			text-decoration: none;
			transition: color 0.3s ease;
		}

		.post-card-title a:hover {
			color: var(--theme-accent);
		}

		.post-card-description {
			margin: 0 0 1rem 0;
			color: var(--theme-quote);
			font-style: italic;
			line-height: 1.5;
		}

		.post-card-tags {
			display: flex;
			flex-wrap: wrap;
			gap: 0.5rem;
		}

		.tag {
			background: var(--theme-accent);
			color: white;
			padding: 0.25rem 0.75rem;
			border-radius: 20px;
			font-size: 0.9rem;
			font-weight: 500;
			text-decoration: none;
			transition: background-color 0.3s ease, transform 0.2s ease;
		}

		.tag:hover {
			background: var(--theme-accent-dark, #1a4d3a);
			transform: translateY(-1px);
		}

		@media (max-width: 768px) {
			.home-page {
				padding: 1rem;
			}

			.hero-content {
				flex-direction: column;
				text-align: center;
				padding: 2rem;
			}

			.hero-title {
				font-size: 2rem;
			}

			.about-content {
				grid-template-columns: 1fr;
			}

			.posts-grid {
				grid-template-columns: 1fr;
				gap: 1.5rem;
			}
		}
	</style>
</PageLayout>
